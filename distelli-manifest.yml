iamchristopher/AscensionServer:

  Build:
    - npm install
    - npm test

  PkgInclude:
    - '*'

  PreInstall:
    - echo "Begin PreInstall"
    - sudo apt-get -y update
    - echo "Installing NVM"
    - wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.29.0/install.sh | bash
    - set +e; source ~/.nvm/nvm.sh; set -e
    - echo "Installing NVM version"
    - nvm install v4.2.1

  PostInstall:
    - echo "Begin PostInstall"
    - set +e; source ~/.nvm/nvm.sh; set -e
    - nvm use v4.2.1
    - echo "Installing PM2"
    - sudo npm i pm2 -g
    - echo "Done Installing PM2"

  Start:
    - echo "Starting application"
    - set +e; source ~/.nvm/nvm.sh; set -e
    - nvm use v4.2.1
    - npm config get prefix
    - pm2 gracefulReload process-production.json

  PostStart:
    - pm2 list

  Terminate:
    - echo "Terminating application"
    - pm2 stop process-production.json
